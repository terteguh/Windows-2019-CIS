---


- name: "2.3.1.3 | PATCH | L1 | Ensure Accounts Guest account status is set to Disabled MS only"
  win_security_policy:
      section: System Access
      key: EnableGuestAccount
      value: 0
  when:
      - rule_2_3_1_3
  tags:
      - level1-memberserver
      - rule_2.3.1.3
      - patch



- name: "2.3.8.3 | PATCH | L1 | Ensure Microsoft network client Send unencrypted password to third-party SMB servers is set to Disabled"
  win_regedit:
      path: HKLM:\System\Currentcontrolset\Services\Lanmanworkstation\Parameters
      name: EnablePlainTextPassword
      data: 0
      type: dword
  when:
      - rule_2_3_8_3
  tags:
      - level1-domaincontroller
      - level1-memberserver
      - rule_2.3.8.3
      - patch


- name: "2.3.11.2 | PATCH | L1 | Ensure Network security Allow LocalSystem NULL session fallback is set to Disabled"
  win_regedit:
      path: HKLM:\System\Currentcontrolset\Control\Lsa\Msv1_0
      name: allownullsessionfallback
      data: 0
      type: dword
  when:
      - rule_2_3_11_2
  tags:
      - level1-domaincontroller
      - level1-memberserver
      - rule_2.3.11.2
      - patch



- name: "2.3.11.7 | PATCH | L1 | Ensure Network security LAN Manager authentication level is set to Send NTLMv2 response only. Refuse LM  NTLM"
  win_regedit:
      path: HKLM:\System\Currentcontrolset\Control\Lsa
      name: LMCompatibilityLevel
      data: 5
      type: dword
  when:
      - rule_2_3_11_7
  tags:
      - level1-domaincontroller
      - level1-memberserver
      - rule_2.3.11.7
      - patch


